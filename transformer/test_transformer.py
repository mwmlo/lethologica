import os
import sys

import numpy
import pytest

SCRIPT_DIR = os.path.dirname(os.path.abspath(__file__))
sys.path.append(os.path.dirname(SCRIPT_DIR))

from transformer.transformer import Transformer


def test_transformer_only_accepts_valid_model():
    with pytest.raises(Exception):
        Transformer("foo")


def test_transformer_encodes():
    transformer = Transformer()
    sentence1 = "Hello World!"
    sentence2 = "The quick brown fox jumps over the lazy dog."
    expected_encoding1 = [
        0.05892980098724365234,
        0.05147081241011619568,
        0.05177668482065200806,
        -0.01716669090092182159,
        0.01015175972133874893,
        0.01560193765908479691,
        -0.00470829941332340240,
        0.07620662450790405273,
        -0.00797413289546966553,
        0.00219075335189700127,
        -0.02763117849826812744,
        0.01679494045674800873,
        -0.04692194983363151550,
        -0.00181872746907174587,
        -0.01217386126518249512,
        0.00575220724567770958,
        -0.05643057823181152344,
        0.03368366137146949768,
        0.02528336830437183380,
        0.06352656334638595581,
        -0.02370261773467063904,
        -0.05566992610692977905,
        0.03010335937142372131,
        0.00864765886217355728,
        -0.01253895647823810577,
        0.04378043487668037415,
        0.02015645056962966919,
        0.06290696561336517334,
        -0.00850011128932237625,
        0.00075178063707426190,
        -0.01136181317269802094,
        0.02970853261649608612,
        -0.00848866254091262817,
        0.04364623501896858215,
        -0.02844768948853015900,
        0.00272654462605714798,
        0.01230151206254959106,
        0.06398065388202667236,
        -0.05839739367365837097,
        0.02402583137154579163,
        -0.02124991454184055328,
        -0.00752611085772514343,
        0.01265851035714149475,
        -0.00017273161211051047,
        -0.02230808697640895844,
        -0.08584624528884887695,
        0.03732039779424667358,
        -0.00405882950872182846,
        0.00939686782658100128,
        -0.00713142752647399902,
        0.04270476102828979492,
        -0.01525020599365234375,
        -0.07611343264579772949,
        0.02301587909460067749,
        0.02968028001487255096,
        0.00644894316792488098,
        0.01372998394072055817,
        -0.05265703052282333374,
        -0.06417549401521682739,
        0.01840315014123916626,
        -0.05275394394993782043,
        -0.05159553512930870056,
        -0.02419093996286392212,
        -0.03700961172580718994,
        0.02034924179315567017,
        0.06638841331005096436,
        -0.01672501116991043091,
        -0.01460707653313875198,
        -0.00628573261201381683,
        -0.03505103662610054016,
        0.04543607681989669800,
        -0.03197517618536949158,
        -0.01457746792584657669,
        -0.02258373610675334930,
        0.05059119313955307007,
        -0.01907788217067718506,
        0.00654614483937621117,
        0.02795511484146118164,
        -0.02736851200461387634,
        0.00673612812533974648,
        -0.05038937553763389587,
        -0.02264654263854026794,
        0.11688761413097381592,
        0.06480646133422851562,
        0.00873525626957416534,
        -0.03182527795433998108,
        0.02940377220511436462,
        0.03044591844081878662,
        0.01767713390290737152,
        0.03906494751572608948,
        -0.04500202462077140808,
        -0.05468628928065299988,
        -0.00237222947180271149,
        0.01988216303288936615,
        0.00109796866308897734,
        -0.03260738402605056763,
        -0.00826460216194391251,
        -0.00251854350790381432,
        -0.02105812728404998779,
        -0.00568942911922931671,
        0.01770978048443794250,
        -0.02263844944536685944,
        0.05597956478595733643,
        -0.04717552289366722107,
        -0.00109529716428369284,
        -0.00031460419995710254,
        0.04666545614600181580,
        -0.08343045413494110107,
        0.02558551169931888580,
        0.07143929600715637207,
        0.03805614635348320007,
        -0.00218581361696124077,
        0.04010817781090736389,
        -0.01571970432996749878,
        0.02703220397233963013,
        0.07741730660200119019,
        0.03655432537198066711,
        -0.02520705759525299072,
        -0.02267157845199108124,
        -0.04152272641658782959,
        -0.03549168258905410767,
        -0.02979012019932270050,
        -0.01116190291941165924,
        -0.01991793513298034668,
        0.05593434348702430725,
        0.00942387245595455170,
        -0.04797489568591117859,
        0.01250039041042327881,
        -0.03209540620446205139,
        -0.00307521596550941467,
        0.00642444612458348274,
        -0.03153393417596817017,
        0.04484976455569267273,
        0.01697051338851451874,
        -0.04205853492021560669,
        0.05903843045234680176,
        0.03828248381614685059,
        -0.04625023528933525085,
        -0.03242527693510055542,
        0.00482171541079878807,
        0.02648747339844703674,
        0.03955996409058570862,
        0.00663719046860933304,
        0.00756102381274104118,
        0.05237480625510215759,
        0.02738546766340732574,
        -0.03244563937187194824,
        0.00423751724883913994,
        -0.02477432787418365479,
        -0.02620378695428371429,
        0.01104453206062316895,
        -0.02469242736697196960,
        -0.00927640497684478760,
        -0.02853026613593101501,
        0.03491957858204841614,
        -0.01365702785551548004,
        -0.06461714953184127808,
        0.03709306940436363220,
        0.03864480182528495789,
        0.04281682148575782776,
        0.03997215256094932556,
        -0.02767830528318881989,
        0.02473505027592182159,
        0.03462923690676689148,
        -0.03623811155557632446,
        0.08010787516832351685,
        0.00377622898668050766,
        0.00634994823485612869,
        0.00442865630611777306,
        0.00250067375600337982,
        0.06658193469047546387,
        0.00443615159019827843,
        0.06424441933631896973,
        -0.02712441794574260712,
        -0.00326655153185129166,
        -0.01225046906620264053,
        0.09878558665513992310,
        -0.02266553975641727448,
        -0.02058319747447967529,
        0.03859748691320419312,
        -0.12338621914386749268,
        -0.06243379786610603333,
        -0.01683990284800529480,
        0.02608347870409488678,
        0.08316671848297119141,
        -0.03562860190868377686,
        0.02278595790266990662,
        -0.00199240585789084435,
        0.00142703787423670292,
        0.03714891895651817322,
        -0.00064135348657146096,
        0.02871061302721500397,
        -0.03196661546826362610,
        0.04509143158793449402,
        -0.00428562425076961517,
        0.02401122078299522400,
        0.02241359651088714600,
        0.00368358683772385120,
        -0.02197503298521041870,
        0.00437168125063180923,
        -0.00457123760133981705,
        0.05524255707859992981,
        -0.04227142408490180969,
        0.03290917351841926575,
        -0.03725218027830123901,
        0.00495430780574679375,
        0.02410480193793773651,
        0.00444520218297839165,
        -0.03462444245815277100,
        0.05971596390008926392,
        -0.08043067157268524170,
        -0.00895515736192464828,
        0.01124060619622468948,
        0.02832892350852489471,
        0.00006398882396752015,
        -0.00777222774922847748,
        0.01261289790272712708,
        -0.07513211667537689209,
        -0.02952942624688148499,
        -0.02417572587728500366,
        0.00209492258727550507,
        -0.00667656911537051201,
        -0.03048903495073318481,
        -0.02934495545923709869,
        0.08553648740053176880,
        0.01855531148612499237,
        0.03181068971753120422,
        0.03122709691524505615,
        0.06070645526051521301,
        -0.01577767729759216309,
        0.03208270296454429626,
        -0.03371334820985794067,
        0.06489723175764083862,
        0.00323109584860503674,
        0.01108841132372617722,
        0.04176760837435722351,
        -0.00130673067178577185,
        -0.05945638194680213928,
        0.02992500178515911102,
        -0.03611519187688827515,
        -0.02207733690738677979,
        -0.05151592940092086792,
        -0.01715162023901939392,
        -0.01990816183388233185,
        -0.02435341477394104004,
        -0.03291848674416542053,
        0.03482871502637863159,
        -0.01341444812715053558,
        -0.00482728797942399979,
        0.05249124020338058472,
        -0.00522883795201778412,
        -0.03221827745437622070,
        0.00350849004462361336,
        -0.02177882939577102661,
        -0.00669889478012919426,
        0.04462275654077529907,
        -0.03985608369112014771,
        0.05853047966957092285,
        0.04421093314886093140,
        -0.01047232653945684433,
        0.04864804446697235107,
        0.00518521061167120934,
        0.01217024400830268860,
        0.03202245011925697327,
        -0.05257010832428932190,
        0.03864235803484916687,
        0.00131819921080023050,
        -0.06099970266222953796,
        -0.00953300856053829193,
        0.00733932293951511383,
        -0.02838687226176261902,
        0.02519105747342109680,
        -0.01076393388211727142,
        0.00999596714973449707,
        0.02685127034783363342,
        -0.06127523258328437805,
        0.00649555306881666183,
        -0.01099091768264770508,
        -0.00644058082252740860,
        -0.04962444305419921875,
        0.01546053681522607803,
        0.03140920028090476990,
        -0.04288907721638679504,
        0.07542779296636581421,
        0.01257027965039014816,
        -0.04229416325688362122,
        0.01239069923758506775,
        0.06656868755817413330,
        0.00061215943424031138,
        -0.02422736957669258118,
        0.02960346266627311707,
        -0.03299323841929435730,
        -0.03927553445100784302,
        0.03364903852343559265,
        0.02216347493231296539,
        -0.01606298424303531647,
        0.10914445668458938599,
        0.00022521674691233784,
        -0.04720174893736839294,
        -0.00835758261382579803,
        0.07834315299987792969,
        -0.00875172577798366547,
        -0.02034706436097621918,
        0.01801916770637035370,
        0.03856302425265312195,
        -0.02678728848695755005,
        0.03564517572522163391,
        -0.06498730182647705078,
        -0.00215684552676975727,
        -0.02478854358196258545,
        0.02080534026026725769,
        -0.03612194582819938660,
        0.02305162511765956879,
        -0.00826227106153964996,
        0.00388179649598896503,
        0.01732435636222362518,
        -0.01899699307978153229,
        -0.02557518146932125092,
        -0.07770451903343200684,
        -0.02035273052752017975,
        -0.01497128792107105255,
        -0.03910987451672554016,
        0.01104952022433280945,
        -0.00021922981250099838,
        0.00869134999811649323,
        -0.02041574008762836456,
        -0.00720001710578799248,
        0.02970396913588047028,
        -0.01974034868180751801,
        0.01454753708094358444,
        0.08304495364427566528,
        -0.01804306171834468842,
        0.06546955555677413940,
        0.00760890217497944832,
        0.04581107571721076965,
        -0.01792122796177864075,
        0.02405214309692382812,
        0.02686851099133491516,
        -0.00959136523306369781,
        -0.07042934000492095947,
        -0.06089713051915168762,
        -0.02287344634532928467,
        -0.01700368337333202362,
        0.00949365738779306412,
        0.02585066854953765869,
        -0.00639551132917404175,
        0.03744669258594512939,
        -0.04547439888119697571,
        0.03282702714204788208,
        -0.05252566933631896973,
        0.02626300044357776642,
        -0.06521084904670715332,
        0.00317090563476085663,
        0.01067374739795923233,
        -0.03535021468997001648,
        -0.05503315851092338562,
        -0.01676785200834274292,
        0.01529285497963428497,
        -0.04654309153556823730,
        0.02141743153333663940,
        -0.00282321637496352196,
        0.00444668252021074295,
        0.02359806746244430542,
        0.02524154819548130035,
        0.03824000805616378784,
        0.04915676638484001160,
        0.00322548486292362213,
        -0.06995676457881927490,
        0.04347008094191551208,
        0.01443080231547355652,
        0.01723081618547439575,
        -0.05937836691737174988,
        0.02837462723255157471,
        0.00129767262842506170,
        -0.04379291832447052002,
        -0.02405786328017711639,
        -0.04507463425397872925,
        -0.00385420909151434898,
        -0.03024964034557342529,
        -0.04331446811556816101,
        -0.04603008180856704712,
        -0.02290813997387886047,
        -0.08016464114189147949,
        -0.01475483831018209457,
        -0.05097632110118865967,
        -0.03659702837467193604,
        0.02768669277429580688,
        -0.02304112352430820465,
        0.04486268013715744019,
        -0.07699541002511978149,
        0.01207518391311168671,
        0.04326266422867774963,
        -0.02185619994997978210,
        -0.06776605546474456787,
        0.01252602972090244293,
        0.00391512317582964897,
        0.01704876683652400970,
        0.03458523005247116089,
        -0.03473516553640365601,
        0.01084915176033973694,
        -0.01327394321560859680,
        0.00384491495788097382,
        0.04405002668499946594,
        -0.02510182000696659088,
        0.02139300107955932617,
        0.05167586356401443481,
        -0.00286854733712971210,
        0.00619891099631786346,
        -0.02334737032651901245,
        0.00126810185611248016,
        -0.00210013077594339848,
        0.00779167935252189636,
        0.06879322230815887451,
        0.07041436433792114258,
        0.00024364095588680357,
        -0.04361940920352935791,
        -0.02352443896234035492,
        0.01547179836779832840,
        0.03042221814393997192,
        -0.03155591711401939392,
        -0.01232979353517293930,
        0.02019624784588813782,
        0.03262983635067939758,
        -0.03068682923913002014,
        0.01026645023375749588,
        0.02072850428521633148,
        0.01450669951736927032,
        -0.02099559828639030457,
        0.03999583423137664795,
        0.06008030101656913757,
        0.05255543440580368042,
        0.05259769409894943237,
        0.07634257525205612183,
        -0.05704707279801368713,
        0.00140532280784100294,
        0.06408663839101791382,
        0.01318917423486709595,
        -0.05790297687053680420,
        0.01510865334421396255,
        0.00284111127257347107,
        0.03485036641359329224,
        -0.00450676400214433670,
        0.06733041256666183472,
        0.07345918565988540649,
        -0.04151429608464241028,
        -0.08183716982603073120,
        -0.01297336537390947342,
        0.03079317323863506317,
        0.01343439798802137375,
        0.01944760791957378387,
        -0.02854928560554981232,
        0.01455134153366088867,
        0.02504595182836055756,
        0.03812589496374130249,
        -0.00993456970900297165,
        -0.01475530955940485001,
        0.05815374106168746948,
        -0.02071913145482540131,
        0.00654998002573847771,
        -0.02316820062696933746,
        -0.01360729988664388657,
        -0.05606526881456375122,
        -0.02865845523774623871,
        0.01209123525768518448,
        0.02713782899081707001,
        0.00923269335180521011,
        -0.05954165756702423096,
        -0.00737748527899384499,
        0.03956421092152595520,
        -0.00857328902930021286,
        -0.05780582502484321594,
        0.02672721073031425476,
        0.00209740013815462589,
        0.00217704940587282181,
        0.05547659099102020264,
        0.02302600070834159851,
        -0.01570221036672592163,
        -0.02558561228215694427,
        0.01644467748701572418,
        0.01841806061565876007,
        0.06940311938524246216,
        -0.02308593131601810455,
        -0.05272109434008598328,
        0.00346837937831878662,
        -0.04116946831345558167,
        -0.02222944051027297974,
        0.00508186733350157738,
        -0.02842263132333755493,
        0.00185828178655356169,
        -0.04978846758604049683,
        -0.00321478047408163548,
        0.04000698775053024292,
        0.01489915233105421066,
        0.03884248435497283936,
        0.07713476568460464478,
        -0.02271676249802112579,
        0.03015687130391597748,
        0.00054297287715598941,
        -0.02401419356465339661,
        0.03890563547611236572,
        -0.02696303837001323700,
        -0.02939379960298538208,
        -0.06165046989917755127,
        -0.02889297902584075928,
        0.00066927651641890407,
        -0.05337378382682800293,
        0.02681232057511806488,
        0.04566713050007820129,
        -0.02367947436869144440,
        -0.00632333429530262947,
        -0.01277381740510463715,
        -0.01824362948536872864,
        -0.01427632290869951248,
        0.00654645916074514389,
        0.01471780799329280853,
        -0.06385292857885360718,
        -0.02777822688221931458,
        0.00102019263431429863,
        0.01562400348484516144,
        0.00111821328755468130,
        0.00298942904919385910,
        -0.03170119225978851318,
        -0.00274279410950839520,
        -0.03574667125940322876,
        -0.02237867750227451324,
        -0.03454136103391647339,
        -0.04081979021430015564,
        -0.02967835217714309692,
        -0.06815022230148315430,
        -0.00300168548710644245,
        -0.01121004391461610794,
        0.01280193403363227844,
        -0.03768682479858398438,
        -0.02588565275073051453,
        -0.04827636852860450745,
        0.03224157914519309998,
        -0.06393117457628250122,
        -0.03358070924878120422,
        -0.02299358509480953217,
        0.01383362803608179092,
        0.00900479685515165329,
        -0.03719387203454971313,
        -0.04038516059517860413,
        0.02774202823638916016,
        -0.03868646174669265747,
        -0.01764594949781894684,
        -0.05097903311252593994,
        0.05910124629735946655,
        -0.01323433499783277512,
        -0.05961913615465164185,
        0.03213020414113998413,
        -0.03696002438664436340,
        -0.01854608766734600067,
        0.03046667575836181641,
        -0.02312992699444293976,
        0.01979666389524936676,
        0.02759197726845741272,
        -0.05312577635049819946,
        -0.03867202624678611755,
        0.07961019128561019897,
        0.00150383927393704653,
        -0.00662571098655462265,
        -0.04733001068234443665,
        -0.05917220935225486755,
        -0.00860566552728414536,
        0.02825465053319931030,
        -0.02587641403079032898,
        -0.01050089951604604721,
        -0.02778904139995574951,
        -0.06137374415993690491,
        -0.01157123316079378128,
        0.03947715088725090027,
        0.07694493979215621948,
        0.00605275714769959450,
        -0.03865575417876243591,
        0.02865853346884250641,
        0.00092482706531882286,
        0.00997976306825876236,
        -0.07603745162487030029,
        0.03421667218208312988,
        -0.01576598361134529114,
        -0.01318751182407140732,
        -0.04903155192732810974,
        -0.04607380926609039307,
        -0.00076898938277736306,
        0.00202792114578187466,
        -0.03398076072335243225,
        -0.02091360278427600861,
        0.00223749806173145771,
        0.07333993911743164062,
        -0.01703664846718311310,
        0.00973620545119047165,
        0.03589725866913795471,
        -0.02494185790419578552,
        0.03528781235218048096,
        0.00363073381595313549,
        0.03334347531199455261,
        0.01749592646956443787,
        -0.00417244527488946915,
        0.08891066908836364746,
        -0.02615228109061717987,
        0.04661380872130393982,
        -0.00027945099282078445,
        0.03026441298425197601,
        0.02360214851796627045,
        0.02259173989295959473,
        -0.05729719996452331543,
        -0.00428513763472437859,
        0.06479523330926895142,
        0.04685892909765243530,
        0.00699683791026473045,
        -0.00555644603446125984,
        0.01561533380299806595,
        -0.04081127047538757324,
        0.02573085390031337738,
        -0.01829629391431808472,
        0.00438213068991899490,
        -0.00836474914103746414,
        -0.06001692637801170349,
        0.01854128018021583557,
        -0.00444165105000138283,
        0.04509328678250312805,
        -0.00743174646049737930,
        0.06284337490797042847,
        0.02513740770518779755,
        -0.04075822979211807251,
        -0.02110919542610645294,
        -0.00905780587345361710,
        0.01166809815913438797,
        -0.01804297231137752533,
        0.00154658383689820766,
        0.01602667011320590973,
        -0.03220263496041297913,
        -0.00017184494936373085,
        -0.07100769877433776855,
        -0.04061648249626159668,
        0.06515222042798995972,
        0.04722409322857856750,
        -0.00503006018698215485,
        0.05345285683870315552,
        0.01875494793057441711,
        -0.02885449677705764771,
        -0.01838915795087814331,
        -0.05712169781327247620,
        -0.01950366422533988953,
        0.04572248831391334534,
        0.03948666155338287354,
        0.04076309502124786377,
        0.00736519414931535721,
        0.02994409762322902679,
        -0.09309589862823486328,
        -0.00945018418133258820,
        0.06394235789775848389,
        -0.02540218830108642578,
        -0.01313645765185356140,
        0.02757655270397663116,
        0.02320783585309982300,
        -0.03670851886272430420,
        0.02799153141677379608,
        -0.00868832971900701523,
        -0.00912960618734359741,
        -0.00823290273547172546,
        -0.02505109086632728577,
        -0.05403963848948478699,
        -0.04720081761479377747,
        -0.02188660763204097748,
        -0.00790818594396114349,
        0.04190229997038841248,
        -0.03482112288475036621,
        0.02114819362759590149,
        0.01700223982334136963,
        0.02340330928564071655,
        0.05045195296406745911,
        0.04775287210941314697,
        0.00108116678893566132,
        0.00120498007163405418,
        -0.01447513885796070099,
        -0.00816984195262193680,
        -0.06602544337511062622,
        0.00343052996322512627,
        -0.05211776122450828552,
        0.06865239143371582031,
        -0.05810356885194778442,
        0.02842188626527786255,
        -0.05270313099026679993,
        -0.01091612037271261215,
        -0.04878619685769081116,
        -0.04942968115210533142,
        -0.02041728980839252472,
        -0.00601778365671634674,
        -0.01191456709057092667,
        0.00643360614776611328,
        0.01304987352341413498,
        0.01726599596440792084,
        -0.02175826206803321838,
        -0.04659445211291313171,
        0.01267332304269075394,
        0.01279087550938129425,
        0.00087102776160463691,
        -0.03511794283986091614,
        -0.01637667603790760040,
        0.04345518350601196289,
        0.08681405335664749146,
        -0.04658897593617439270,
        0.02105978690087795258,
        0.03186038136482238770,
        -0.02298454567790031433,
        0.04720028117299079895,
        0.05597766116261482239,
        -0.03424463048577308655,
        0.01137842237949371338,
        0.04200503602623939514,
        0.05226286500692367554,
        -0.04161098971962928772,
        0.04860679060220718384,
        0.03447463363409042358,
        0.02105125971138477325,
        -0.01156573742628097534,
        -0.00085094361566007137,
        0.03448647260665893555,
        -0.03218369930982589722,
        0.02691854164004325867,
        0.02800889499485492706,
        0.03086722083389759064,
        -0.00830766372382640839,
        0.02366738766431808472,
        0.02879962883889675140,
        0.01685119234025478363,
        -0.00318089942447841167,
        -0.04906105995178222656,
        0.03428237885236740112,
        0.03449966758489608765,
        0.02107278630137443542,
        0.09037327766418457031,
        -0.01589089445769786835,
        -0.04787091910839080811,
        -0.06753183901309967041,
        -0.02417752332985401154,
        0.00644952477887272835,
        0.02920701913535594940,
        0.01772972941398620605,
        -0.01476719882339239120,
        0.01124155893921852112,
        0.01411563623696565628,
        -0.01271413639187812805,
        -0.01628368347883224487,
        0.02036945521831512451,
        -0.06472014635801315308,
        0.02154939621686935425,
        0.00743112526834011078,
        -0.01180225051939487457,
        0.00044008184340782464,
        -0.03134575113654136658,
        -0.00904341880232095718,
        0.04151039198040962219,
        -0.02871078625321388245,
        -0.00417239218950271606,
        -0.04509008675813674927,
        -0.03041611239314079285,
        -0.03926184028387069702,
        -0.01065518986433744431,
        0.00287209474481642246,
        0.01608142256736755371,
        0.05133354291319847107,
        -0.00393032515421509743,
        0.02672670409083366394,
        0.04105709120631217957,
        0.00553854508325457573,
    ]
    expected_encoding2 = [
        -0.04591509699821472168,
        -0.02193363569676876068,
        -0.01151941809803247452,
        0.00743621075525879860,
        -0.01369011588394641876,
        0.01599595323204994202,
        -0.00276873144321143627,
        -0.02808916009962558746,
        -0.03890164196491241455,
        0.00620969058945775032,
        -0.02280358411371707916,
        -0.00721878325566649437,
        -0.03170759603381156921,
        -0.04656082019209861755,
        -0.04022534936666488647,
        -0.01885470002889633179,
        -0.00494931079447269440,
        -0.04330555722117424011,
        -0.03453772515058517456,
        -0.06488741189241409302,
        0.03863494843244552612,
        -0.04439761117100715637,
        -0.07750941067934036255,
        -0.06125491484999656677,
        0.00576923461630940437,
        0.03320418298244476318,
        -0.02098899148404598236,
        0.04920447617769241333,
        -0.01397125888615846634,
        0.05188405141234397888,
        -0.02285418286919593811,
        -0.04832716658711433411,
        0.02428770065307617188,
        0.01635246351361274719,
        0.03073679283261299133,
        0.05040865391492843628,
        0.03064714372158050537,
        -0.05329910293221473694,
        -0.04318164661526679993,
        -0.01128634344786405563,
        0.02851460315287113190,
        0.05422640219330787659,
        -0.05049999803304672241,
        0.00393275357782840729,
        0.00397090008482336998,
        -0.02369511500000953674,
        -0.00558135751634836197,
        -0.01964628323912620544,
        0.06431501358747482300,
        -0.03229478374123573303,
        -0.01393403299152851105,
        0.02331704832613468170,
        -0.02038192935287952423,
        0.01714444346725940704,
        -0.05998773127794265747,
        -0.02277651056647300720,
        0.03804016113281250000,
        0.00837922655045986176,
        -0.02217686921358108521,
        0.01917755417525768280,
        0.00735010113567113876,
        0.00081555353244766593,
        0.03479747101664543152,
        0.01704968139529228210,
        -0.07323765009641647339,
        0.00579143827781081200,
        0.02273287437856197357,
        0.04591989517211914062,
        0.01159072574228048325,
        0.01039916928857564926,
        0.03919220343232154846,
        -0.03809410706162452698,
        0.01445051375776529312,
        0.06856325268745422363,
        0.01374989002943038940,
        0.01067656651139259338,
        0.05814502388238906860,
        0.00416180118918418884,
        0.00411956384778022766,
        0.03345661610364913940,
        0.02898256853222846985,
        0.03254400193691253662,
        0.02358292788267135620,
        0.06358741968870162964,
        0.01365111023187637329,
        0.10862105339765548706,
        0.04405586048960685730,
        0.00546941487118601799,
        -0.06558205932378768921,
        0.02569902129471302032,
        -0.05327305942773818970,
        -0.06856139749288558960,
        -0.01118113379925489426,
        0.01640613004565238953,
        -0.06262643635272979736,
        0.01488764304667711258,
        0.04423117637634277344,
        -0.03926189988851547241,
        0.05351248383522033691,
        -0.02650794014334678650,
        -0.05394789949059486389,
        -0.01018019486218690872,
        -0.00572664709761738777,
        0.00282696820795536041,
        -0.02502239868044853210,
        -0.00523426989093422890,
        -0.00773877231404185295,
        -0.03687234967947006226,
        0.01764967851340770721,
        0.01480876002460718155,
        0.01092120260000228882,
        -0.03148122504353523254,
        0.03885998949408531189,
        0.03488996997475624084,
        0.00691797165200114250,
        0.05391733348369598389,
        -0.02323387004435062408,
        0.01258205436170101166,
        -0.00540224835276603699,
        0.03806025907397270203,
        -0.00046946480870246887,
        -0.00210223905742168427,
        0.01072998903691768646,
        -0.01981734484434127808,
        0.01653065159916877747,
        -0.05533101782202720642,
        -0.05403628200292587280,
        0.00721713900566101074,
        0.02207382395863533020,
        0.03536789119243621826,
        0.03187333792448043823,
        0.00007640486001037061,
        -0.00077614461770281196,
        -0.06627133488655090332,
        0.01954182609915733337,
        0.05628933012485504150,
        0.01898456364870071411,
        0.02943935617804527283,
        -0.06770242750644683838,
        0.02615605853497982025,
        -0.00781772844493389130,
        0.01163268648087978363,
        0.00648734997957944870,
        -0.01634564064443111420,
        0.02600853517651557922,
        0.02832832746207714081,
        -0.03453712165355682373,
        -0.02498045004904270172,
        0.03256470337510108948,
        0.03699818998575210571,
        -0.02349208295345306396,
        0.02042226865887641907,
        -0.01227300520986318588,
        0.05166302621364593506,
        -0.06323945522308349609,
        -0.00145091209560632706,
        -0.04561788216233253479,
        -0.04857849329710006714,
        0.04229028522968292236,
        0.01109958440065383911,
        -0.00355790206231176853,
        -0.03914452716708183289,
        -0.00717228930443525314,
        -0.03687343373894691467,
        0.01589876785874366760,
        -0.01879126764833927155,
        0.04723720625042915344,
        -0.00283628911711275578,
        -0.07958589494228363037,
        0.04266386106610298157,
        0.01007965020835399628,
        0.02843739092350006104,
        0.01133347675204277039,
        0.00207332964055240154,
        0.00845531187951564789,
        0.02816437929868698120,
        -0.00187371415086090565,
        -0.05548064783215522766,
        0.01172557659447193146,
        0.04228335246443748474,
        -0.04854881018400192261,
        -0.00704161729663610458,
        -0.01588986627757549286,
        0.04811415076255798340,
        -0.01265957951545715332,
        -0.04977134987711906433,
        0.05177501589059829712,
        0.00653893593698740005,
        -0.01022067293524742126,
        -0.03168195486068725586,
        0.05482167378067970276,
        -0.00498978327959775925,
        -0.06885362416505813599,
        -0.04500089585781097412,
        0.01479840930551290512,
        -0.12686161696910858154,
        -0.04696506634354591370,
        -0.10699899494647979736,
        0.00354232033714652061,
        -0.02676536142826080322,
        -0.04193230345845222473,
        -0.05717102065682411194,
        0.03108582086861133575,
        0.00215326854959130287,
        0.02316725626587867737,
        0.04821344092488288879,
        -0.02312564663589000702,
        0.02578935213387012482,
        -0.01724573597311973572,
        -0.03012471273541450500,
        0.02017047442495822906,
        0.01639504730701446533,
        -0.00404749857261776924,
        0.02984536625444889069,
        -0.01022928301244974136,
        0.00723932031542062759,
        0.00212931772693991661,
        -0.04160653427243232727,
        -0.03530601039528846741,
        0.03380542621016502380,
        -0.04580986499786376953,
        0.03666350990533828735,
        -0.02427714690566062927,
        0.02279142290353775024,
        0.04229316860437393188,
        0.00919816084206104279,
        0.05634243413805961609,
        0.00458356784656643867,
        0.04336971417069435120,
        0.01205837819725275040,
        0.01986993104219436646,
        0.00980630610138177872,
        -0.00216309539973735809,
        0.03377697244286537170,
        -0.06573812663555145264,
        -0.01504778768867254257,
        -0.01409854739904403687,
        0.00187905761413276196,
        0.05445865169167518616,
        -0.02026078850030899048,
        -0.02956217154860496521,
        0.02942986786365509033,
        0.03599960356950759888,
        0.01751151122152805328,
        0.01824180223047733307,
        -0.03612629696726799011,
        0.06837898492813110352,
        0.06465613096952438354,
        -0.07813874632120132446,
        -0.04756423458456993103,
        0.00612308830022811890,
        0.01119913719594478607,
        0.01459948066622018814,
        -0.06853806227445602417,
        -0.00797238573431968689,
        -0.01961069740355014801,
        -0.05538471043109893799,
        -0.01766906864941120148,
        0.02946826815605163574,
        0.00970768183469772339,
        0.09755368530750274658,
        0.01378421299159526825,
        0.00099091499578207731,
        0.04222941026091575623,
        0.01594855450093746185,
        0.01321260817348957062,
        -0.05933852493762969971,
        0.00641043484210968018,
        -0.04580806195735931396,
        -0.00338345346972346306,
        0.05467926338315010071,
        0.00652117468416690826,
        0.02418077550828456879,
        -0.02075339853763580322,
        -0.00067133648553863168,
        -0.07182496041059494019,
        0.05356460809707641602,
        0.03792407736182212830,
        0.04255387932062149048,
        -0.07164255529642105103,
        -0.02730507031083106995,
        0.03266601637005805969,
        -0.01749961264431476593,
        0.04582428932189941406,
        0.02549000270664691925,
        -0.00251523195765912533,
        0.04312099143862724304,
        0.03966865688562393188,
        -0.02365236543118953705,
        0.02070292085409164429,
        0.04456748068332672119,
        0.00822277273982763290,
        -0.00781696382910013199,
        0.00042659832979552448,
        -0.08921339362859725952,
        0.01989092491567134857,
        0.04175829142332077026,
        0.01377003174275159836,
        0.04900933429598808289,
        0.01528767403215169907,
        0.05303254723548889160,
        -0.04828522354364395142,
        0.01369174569845199585,
        -0.02624421752989292145,
        0.05482231825590133667,
        0.01913380995392799377,
        0.02340207993984222412,
        0.02660751901566982269,
        -0.03145048022270202637,
        -0.03292364254593849182,
        0.02281371876597404480,
        -0.00484913634136319160,
        0.02303620986640453339,
        -0.05186299607157707214,
        -0.05659042671322822571,
        0.01454562321305274963,
        -0.09152642637491226196,
        0.03458538651466369629,
        -0.04773057252168655396,
        -0.04389234259724617004,
        0.05122335627675056458,
        -0.01823863759636878967,
        -0.01049443986266851425,
        -0.09773621708154678345,
        0.01864378899335861206,
        -0.00521238194778561592,
        -0.05155005678534507751,
        0.03938369452953338623,
        -0.09558566659688949585,
        0.05026683211326599121,
        0.04639349877834320068,
        -0.02644458040595054626,
        -0.00822518765926361084,
        -0.00980788748711347580,
        -0.04592200368642807007,
        0.01124312449246644974,
        0.03853976354002952576,
        -0.02372306585311889648,
        0.02682632207870483398,
        -0.06094417721033096313,
        0.02546306885778903961,
        0.01672797091305255890,
        0.01286154985427856445,
        0.05204565823078155518,
        -0.02654409036040306091,
        0.01280394475907087326,
        -0.01733262091875076294,
        0.08199546486139297485,
        0.04424600303173065186,
        -0.07661967724561691284,
        0.04426047578454017639,
        -0.01421840488910675049,
        0.05865487456321716309,
        -0.02038574405014514923,
        -0.02081508189439773560,
        -0.08491572737693786621,
        0.03383674100041389465,
        -0.06322576850652694702,
        -0.04096946492791175842,
        0.07600799202919006348,
        -0.02337942086160182953,
        0.02979304827749729156,
        0.04419100657105445862,
        -0.02830040827393531799,
        0.01074811909347772598,
        -0.03519472852349281311,
        0.04582550004124641418,
        -0.02362584508955478668,
        0.04159120470285415649,
        -0.00484197260811924934,
        0.04359100013971328735,
        0.02093173377215862274,
        0.03333805873990058899,
        0.00592328980565071106,
        0.05356841534376144409,
        0.03965266048908233643,
        -0.01390170957893133163,
        -0.03448320180177688599,
        0.00086725229630246758,
        -0.02272081561386585236,
        -0.04009861499071121216,
        -0.03689923137426376343,
        -0.03747914731502532959,
        0.01135657075792551041,
        0.05351323261857032776,
        -0.00007589170854771510,
        -0.02854235284030437469,
        -0.04920819401741027832,
        0.06767531484365463257,
        0.00609874306246638298,
        0.00798622891306877136,
        0.01450204756110906601,
        0.01866705156862735748,
        -0.06507073342800140381,
        -0.02410810068249702454,
        0.02523252740502357483,
        -0.02751243114471435547,
        0.02968633733689785004,
        -0.00713191507384181023,
        0.03878036886453628540,
        -0.05540566146373748779,
        -0.00888769701123237610,
        0.01990788057446479797,
        0.04486576840281486511,
        -0.01241736765950918198,
        -0.00029943839763291180,
        -0.01634247042238712311,
        -0.01602237299084663391,
        0.05245812982320785522,
        -0.01992036215960979462,
        0.01650260947644710541,
        -0.00442366441711783409,
        0.02327012643218040466,
        -0.01988212391734123230,
        0.01213997043669223785,
        0.02857493236660957336,
        0.00261199660599231720,
        0.04128793999552726746,
        -0.03479861468076705933,
        -0.04045410081744194031,
        0.02276370488107204437,
        0.03461417183279991150,
        -0.02045970223844051361,
        0.03660433366894721985,
        -0.02710023336112499237,
        -0.04136489704251289368,
        -0.00039306847611442208,
        0.04192972928285598755,
        -0.03580175340175628662,
        0.00670944154262542725,
        -0.04097750410437583923,
        0.04012820124626159668,
        -0.06452251225709915161,
        0.00403491267934441566,
        -0.02279063127934932709,
        -0.00884749926626682281,
        0.00211798539385199547,
        -0.04137425124645233154,
        0.01510903239250183105,
        0.00086242321413010359,
        -0.01165672764182090759,
        -0.02531409263610839844,
        -0.02929943427443504333,
        0.04414252936840057373,
        0.00983259826898574829,
        -0.02910175174474716187,
        0.10810871422290802002,
        -0.02778943441808223724,
        -0.05721802264451980591,
        0.06147976964712142944,
        0.01845654286444187164,
        0.04841164499521255493,
        0.01990627311170101166,
        -0.00457492610439658165,
        0.02649932540953159332,
        -0.01888245530426502228,
        -0.01217593532055616379,
        0.01843944378197193146,
        0.00862702634185552597,
        -0.01473333034664392471,
        -0.01387829426676034927,
        0.03665854781866073608,
        -0.00245942897163331509,
        -0.08009210973978042603,
        0.02408521249890327454,
        0.00003075929998885840,
        -0.03293136879801750183,
        0.02900516428053379059,
        -0.00315500888973474503,
        0.02851012162864208221,
        -0.04907485097646713257,
        -0.02983376756310462952,
        -0.03942278772592544556,
        0.02830758132040500641,
        0.03360630571842193604,
        -0.01571496017277240753,
        0.01230024173855781555,
        0.01959359645843505859,
        -0.00710015138611197472,
        0.00458155898377299309,
        0.00674983765929937363,
        0.07537339627742767334,
        0.00439145369455218315,
        0.00164380751084536314,
        -0.01133662275969982147,
        -0.02529396116733551025,
        -0.05697059631347656250,
        0.05173989385366439819,
        0.00158832001034170389,
        0.04129875078797340393,
        0.04759873077273368835,
        -0.00173366162925958633,
        0.06668037921190261841,
        -0.04111363366246223450,
        0.05699156597256660461,
        0.04648797959089279175,
        0.00537785375490784645,
        0.02586768008768558502,
        -0.01214028149843215942,
        0.04265039786696434021,
        0.03917668387293815613,
        0.09001561999320983887,
        -0.04804285988211631775,
        0.04035364463925361633,
        -0.01649675332009792328,
        0.02245965600013732910,
        -0.04434446245431900024,
        -0.02225834876298904419,
        -0.02072381041944026947,
        0.03195060789585113525,
        0.06282711774110794067,
        -0.02161153405904769897,
        -0.01564415544271469116,
        -0.02470789477229118347,
        -0.00319523550570011139,
        0.01897214911878108978,
        -0.01643291674554347992,
        0.01131888944655656815,
        0.02024341002106666565,
        -0.03645654022693634033,
        -0.05910129845142364502,
        -0.00013149720325600356,
        0.00787316914647817612,
        0.02144280634820461273,
        0.02310751192271709442,
        -0.03472002968192100525,
        -0.02185402251780033112,
        0.01583804935216903687,
        -0.01088990550488233566,
        0.00611320044845342636,
        -0.02587667293846607208,
        0.00066326337400823832,
        0.00530032487586140633,
        -0.03591072931885719299,
        -0.06506313383579254150,
        0.01193613931536674500,
        0.03814544901251792908,
        -0.01696913503110408783,
        0.03425424918532371521,
        0.00774601846933364868,
        -0.03826802596449851990,
        0.00555927446112036705,
        -0.06576386839151382446,
        0.03306468576192855835,
        -0.02177323959767818451,
        -0.02287573553621768951,
        0.02154972963035106659,
        -0.00567867094650864601,
        0.03964529186487197876,
        0.03785848617553710938,
        0.06834511458873748779,
        -0.00151534122414886951,
        -0.01003643311560153961,
        0.03344362229108810425,
        -0.04316527023911476135,
        -0.01930872350931167603,
        0.01105146948248147964,
        -0.00739398086443543434,
        0.01547137275338172913,
        0.06364512443542480469,
        0.05812804773449897766,
        0.03237675502896308899,
        -0.01475942321121692657,
        -0.01976313628256320953,
        -0.05994390696287155151,
        0.02548423781991004944,
        -0.01182175800204277039,
        0.03994719684123992920,
        -0.01720400713384151459,
        0.00639023259282112122,
        -0.01191941369324922562,
        0.03433427959680557251,
        -0.01993927918374538422,
        -0.04081314057111740112,
        -0.03362758085131645203,
        -0.03274634853005409241,
        0.01875901594758033752,
        0.02900296077132225037,
        -0.06483305245637893677,
        -0.00223051314242184162,
        -0.01477870903909206390,
        0.01450567599385976791,
        -0.04718979075551033020,
        0.02669953368604183197,
        0.00111302523873746395,
        0.01373010315001010895,
        -0.03528787195682525635,
        -0.02267120033502578735,
        0.00749219255521893501,
        0.04053083434700965881,
        -0.05089223012328147888,
        -0.00496101705357432365,
        -0.05563863739371299744,
        -0.01598930172622203827,
        0.03440859168767929077,
        0.00356468348763883114,
        0.02448297850787639618,
        0.01269115041941404343,
        -0.02754789963364601135,
        0.07252991199493408203,
        -0.00186585693154484034,
        -0.00136286625638604164,
        0.02840845286846160889,
        -0.00619693286716938019,
        0.04230608418583869934,
        0.05387663096189498901,
        0.00752583099529147148,
        -0.02042867429554462433,
        -0.04696232452988624573,
        0.00826894026249647141,
        -0.00266126077622175217,
        -0.03633137047290802002,
        -0.04034163430333137512,
        -0.07699021697044372559,
        0.02926401607692241669,
        -0.00760861812159419060,
        -0.06638025492429733276,
        0.01096170488744974136,
        0.00956375896930694580,
        0.00011097540846094489,
        -0.02423203364014625549,
        0.03078662417829036713,
        0.06413004547357559204,
        0.02252315916121006012,
        -0.00505360634997487068,
        -0.02929657138884067535,
        0.00486114993691444397,
        -0.01625828258693218231,
        0.00894077029079198837,
        -0.00796198938041925430,
        -0.01574765145778656006,
        0.02120931446552276611,
        -0.02676348015666007996,
        -0.00450937729328870773,
        0.00493188109248876572,
        0.07582253962755203247,
        0.00316219753585755825,
        -0.03662214428186416626,
        0.00817489065229892731,
        0.02651341073215007782,
        0.00822003558278083801,
        -0.00271582789719104767,
        0.00925847142934799194,
        -0.02098594605922698975,
        0.01861303672194480896,
        -0.01949232816696166992,
        0.06263456493616104126,
        -0.07625183463096618652,
        0.01623061858117580414,
        -0.01396782137453556061,
        -0.04098285362124443054,
        0.02125253900885581970,
        -0.01590193621814250946,
        -0.04728557541966438293,
        0.04138537123799324036,
        -0.02886028774082660675,
        -0.00699305348098278046,
        0.06887180358171463013,
        0.01226097904145717621,
        0.03461525961756706238,
        -0.00064727850258350372,
        -0.04314715415239334106,
        0.05855199322104454041,
        -0.00639676256105303764,
        0.02979108318686485291,
        0.00451779738068580627,
        -0.02958483062684535980,
        -0.02424313873052597046,
        0.03106131963431835175,
        0.08426336199045181274,
        -0.07347119599580764771,
        0.00081945437705144286,
        -0.00943828746676445007,
        -0.00233677914366126060,
        -0.00560846691951155663,
        -0.00885079149156808853,
        -0.01463896874338388443,
        0.02196279168128967285,
        0.02389423921704292297,
        0.03650937229394912720,
        -0.02517467364668846130,
        -0.03128460422158241272,
        0.04051746055483818054,
        0.09531962126493453979,
        -0.03443888574838638306,
        0.02138948440551757812,
        0.00674453191459178925,
        0.03371404856443405151,
        -0.00995850190520286560,
        0.04127214103937149048,
        -0.05475361645221710205,
        0.04354650899767875671,
        0.00981135293841362000,
        0.04280164837837219238,
        -0.01219520997256040573,
        -0.06868368387222290039,
        0.01296472828835248947,
        -0.03740835562348365784,
        -0.05849463492631912231,
        -0.00775505835190415382,
        0.01437307894229888916,
        0.01274661161005496979,
        0.06372009962797164917,
        -0.05938008055090904236,
        0.01456470694392919540,
        0.00042486362508498132,
        -0.02794287353754043579,
        0.01692703552544116974,
        0.07190656661987304688,
        -0.02902572043240070343,
        -0.02305427379906177521,
        -0.01368884090334177017,
        0.09469042718410491943,
        0.00558942416682839394,
        0.02492310479283332825,
        -0.00437371758744120598,
        0.03018749691545963287,
        0.00695022847503423691,
        -0.00792341586202383041,
        -0.00747702270746231079,
        0.00804549455642700195,
        0.07571769505739212036,
        0.02615101821720600128,
        -0.02873085811734199524,
        -0.02724046818912029266,
        -0.02972309105098247528,
        -0.00066325970692560077,
        -0.05294326692819595337,
        0.01261818781495094299,
        0.00032706063939258456,
        0.02232648804783821106,
        -0.02817125990986824036,
        -0.02490885555744171143,
        0.01715203374624252319,
        -0.01730437204241752625,
        -0.00593300582841038704,
        -0.03062756732106208801,
        -0.00315005355514585972,
        -0.05175928026437759399,
        0.02959324419498443604,
        0.03327236324548721313,
        -0.06733841449022293091,
        0.02077114209532737732,
        -0.07526221126317977905,
        -0.00594394048675894737,
        0.00589285697788000107,
        -0.00344068650156259537,
        -0.03836641460657119751,
        0.03873994573950767517,
        0.04802572354674339294,
        0.06393684446811676025,
        0.01694445498287677765,
        -0.00179996574297547340,
        0.02137543819844722748,
        0.02511709369719028473,
        0.01678267493844032288,
        0.02598159946501255035,
        -0.04655462875962257385,
        -0.03861162811517715454,
        0.04838377609848976135,
        -0.05542917922139167786,
        0.02290282212197780609,
        -0.03963153809309005737,
        0.01614267751574516296,
        0.02453705295920372009,
        0.02519365027546882629,
        0.06536080688238143921,
        0.02341024391353130341,
    ]
    # Encode the sentences using the transformer
    transformer_encodings = transformer.encode([sentence1, sentence2])
    # Check the returned encodings are equal to the expected encodings within a tolerance (atol)
    assert numpy.allclose(transformer_encodings[0], expected_encoding1, atol=1e-04)
    assert numpy.allclose(transformer_encodings[1], expected_encoding2, atol=1e-04)
